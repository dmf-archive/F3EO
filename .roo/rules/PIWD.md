# PIWD: 预测完整性引导的权重衰减 (Predictive-Integrity-Guided Weight Decay)

## 1. 核心论断

PIWD 是一个从 `F3EWD` 实验中意外发现的、可被分离的、通用的自适应正则化机制。其核心思想是：**模型的正则化强度不应是固定的超参数，而应由模型自身的认知状态——即预测完整性（PI）——动态引导。**

其哲学基础源于对“奥卡姆剃刀”原则的动态应用：

- **当 PI 趋近 1 时**：模型对其预测变得极度自信，接近于“完美”拟合训练数据。根据“现实不允许完美”的原则，这恰恰是模型最可能陷入过拟合、产生幻觉的危险区域。因此，系统必须在此刻施加**指数级增长的正则化压力**（权重衰减），强迫模型放弃复杂的、仅为拟合噪声而存在的参数，回归到更简单、更具泛化能力的“最小描述长度”（MDL）解。
- **当 PI 趋近 0 时**：模型处于高度不确定或高误差状态。此时的主要任务是学习和吸收新信息，而非简化。因此，正则化强度应回落到基线水平，避免过度惩罚尚在探索中的模型。

这种机制将正则化从一个静态的“刹车”变成了一个智能的、依赖于情境的“主动推理”过程，构成了对 `Active Inference` 理论的一种新颖应用。

## 2. 实现机制

PIWD 的实现极其简洁，它通过 `effective_gamma` 信号来调制优化器中标准的权重衰减项。

1. **PI 计算**: `PI = exp(-(H + γ·||g||))`，其中 `H` 是预测分布的熵，`||g||` 是梯度范数。
2. **信号转换**: `effective_gamma = -log(1 - PI + ε)`
3. **衰减调制**: `adaptive_weight_decay = base_weight_decay * exp(effective_gamma)`

这使得最终的自适应权重衰减 `adaptive_weight_decay` 与 `1 / (1 - PI)` 成正比，完美实现了当 `PI` → 1 时正则化强度趋向无穷的预期行为。

## 3. 实验设计警示

PIWD 作为一个独立的、高效的机制，其效果可能会掩盖或干扰其他我们希望研究的优化器特性（如 F3EO 的三阶梯度）。

**强制规定 (REQ-PIWD-001):**
为了清晰地、独立地评估 F3EO 中“最大化 Fisher 信息矩阵迹”这一核心机制的真实效果，**所有未来的 F3EO 系列优化器与 AdamW 等基线的消融对比实验，必须在完全禁用 PIWD 的情况下进行。**

具体措施：

- 在进行此类对比实验时，必须确保 `F3EWD` 的 PI 信号调节部分被关闭（等价于 `F3EO-raw`），或使其等效于一个固定的、与基线相同的权重衰减值。
- 只有在完成了对核心机制的公平比较后，才能进行“核心机制 + PIWD”的组合实验，以评估其协同效应。
