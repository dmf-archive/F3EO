# F3EPI: 预测完整性引导的F3EO

## 问题陈述

从 wikitext2 实验观察到：F3EO 在第 10epoch 达到最佳验证困惑度 788.26 后发生过拟合，验证困惑度从 788.26 恶化至 851.03。这证实了 F3EO 的"强制复杂度最大化"在训练后期成为过拟合源。

## 理论框架：预测完整性(PI)

根据 IPWT 理论，预测完整性定义为：

`PIₜ = exp(-α · (Inaccuracyₜ + γ · Complexityₜ))`

PI 通过负指数压缩自然界定为[0,1]区间，但我们可以利用其**对数形式**来获得符号可变性：

`log(PIₜ) = -α · main_loss - αγ · ‖g‖`

这给出了一个**线性化的协同度量**，其符号直接指示系统状态：

- **负值**：高误差或高复杂度（需要调整）
- **正值**：低误差且低复杂度（理想状态）

## F3EPI 的核心机制

### 1. 双梯度分解

我们将优化目标分解为两个互补的梯度分量：

`g_eff = g_main + β_complexity · δ_complexity`

其中：

- `g_main = -∇L`：标准准确性梯度
- `δ_complexity = ∇‖g‖²`：复杂度敏感度梯度（F3EO 的核心）
- `β_complexity = tanh(log(PI))`：复杂度调节系数

### 2. 协同平衡原理

利用`log(PI)`的符号和大小实现**自适应方向调节**

`β_complexity = tanh(log(PI))`

**方向逻辑**：

- **高 PI 状态** (`log(PI) > 0`): `β_complexity > 0`，**增强复杂度惩罚**，主动探索更精简的表示
- **低 PI 状态** (`log(PI) < 0`): `β_complexity < 0`，**反转复杂度惩罚**，优先吸收预测误差
- **临界状态** (`log(PI) ≈ 0`): `β_complexity ≈ 0`，保持当前平衡。

## 预期行为模式

- **训练早期**：高 loss 导致 log(PI) << 0，β_complexity < 0，抑制复杂度，优先准确性
- **训练中期**：loss 下降，log(PI)趋近 0，平滑过渡
- **训练后期**：低 loss 使 log(PI) > 0，β_complexity > 0，轻微复杂度增强防止欠拟合
- **过拟合边界**：当复杂度过度增加时，log(PI)再次变负，自动抑制
