# ARS 演进提案：自适应几何感知 (Adaptive Geometric Awareness)

## 1. 背景与动机

在 `AdaRMSuon` 优化器中，`ARS` 通过注入正交于基础梯度的“剪切力” v_flat 来引导模型进入平坦盆地。
目前的实现存在两个硬编码瓶颈：

1. 静态强度 (α)：无论几何漂移多严重，注入强度恒定，可能导致有害干涉。
2. 静态周期 (k)：无论流形曲率如何，固定步数后才重新同步，可能在平坦区浪费计算量，或在剧烈变化区失效。

## 2. 方案一：自适应强度 (Adaptive α_t)

### 2.1 核心逻辑

根据当前梯度 g_t 与缓存平坦度向量 v_flat 的对齐程度动态缩放注入强度。

### 2.2 数学形式

定义干涉因子 ϕ_t：

ϕ_t = |⟨g_t, v_flat⟩| / (‖g_t‖ ⋅ ‖v_flat‖)

自适应律：

α_t = α_max ⋅ (1 - ϕ_t)ᵞ

- α_max：配置中的 `alpha` 上限。
- γ (Sensitivity)：敏感度系数。γ=1 为线性衰减，γ=2 为更激进的平方抑制。
- 物理直觉：当 g_t 开始向 v_flat 方向偏转时，说明 v_flat 已不再纯粹是“剪切力”，应自动压低其权重以保护收敛稳定性。

## 3. 方案二：自适应预算 (Adaptive Budget k_t)

### 3.1 核心逻辑

将 k 从“固定周期”转变为“最大容忍周期”。引入 几何一致性阈值 (Cosine Limit)。

### 3.2 判定机制

在每个 Lazy Step，监控 ϕ_t：

- 若 $\phi_t \le \phi_{limit}$：继续 Lazy 模式，复用 $v_{flat}$。
- 若 $\phi_t > \phi_{limit}$ 或 $step \ge k_{max}$：强制触发 Sync Step。
