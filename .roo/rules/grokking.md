# 优化器与 Grokking/过拟合跳出表现调研笔记

> 核心发现：**Muon 优化器是目前唯一被实验证明能显著加速 Grokking 现象的优化器**。它通过正交梯度更新、层自适应步长和谱范数约束，促进更广泛的探索并防止“softmax 崩溃”，从而有效跳出过拟合吸引盆。

## 1. Grokking 现象：从过拟合到顿悟

Grokking 是一种独特的学习动态，模型在训练集上迅速达到完美拟合，但验证性能长期停滞，随后在某个临界点突然跃升至完美泛化。

- **LU 机制**：训练损失呈 L 形下降，测试损失呈 U 形（先上升后下降）。
- **清理阶段 (cleanup phase)**：泛化跃升时，权重衰减移除用于记忆的权重分量，“清理”出泛化性更强的电路。
- **测试基准**：模算术 (modular arithmetic) 和 10 位二进制字符串奇偶性。

## 2. 优化器表现与“逃离”机制

| 类型 | 优化器 | 关键特性 | 在 Grokking/过拟合中的作用 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| 一阶 | **SGD** | 基础梯度下降，可加动量 | 梯度噪声可帮助逃离鞍点，但收敛慢 | 基准 |
| 一阶 | **Adam/AdamW** | 自适应学习率，动量，解耦权重衰减 | 加速收敛，权重衰减支持“清理阶段” | **基准较长 Grokking 轮次 (153.09)** |
| 二阶 | **AdaHessian** | Hutchinson 方法估计 Hessian 对角线 | 利用曲率重标度梯度，对超参数更鲁棒 | 无明确 Grokking 加速报告 |
| 二阶 | **KFAC** | Kronecker 积分解近似 Fisher 信息 | 更快迭代收敛 (10-20x)，但计算开销大 | 无明确 Grokking 加速报告 |
| 二阶 | **Shampoo** | 为张量每个维度维护预处理矩阵 | 严格收敛保证，变体可降低内存开销 | 无明确 Grokking 加速报告 |
| 一阶 | **Muon** | 正交梯度更新、层自适应步长、谱范数约束 | **显著加速 Grokking (轮次降至 102.89)**，防止 softmax 崩溃，促进广泛探索 | **唯一实验验证可加速 Grokking** |

**常见“逃离”机制**：

- **随机性注入**：SGD 梯度噪声、动量。
- **自适应学习率**：Adam 等通过梯度方差缩放步长。
- **结构性正则化**：权重衰减（清理记忆权重）、Dropout。
- **二阶信息**：在低曲率区域大步长，更有效逃离鞍点。

---
**GitHub 仓库**：

- Muon: <https://github.com/KellerJordan/Muon>
- Grokking 复现: <https://github.com/Sea-Snell/grokking>
- Omnigrok: <https://github.com/KindXiaoming/Omnigrok>
