---
title: "ADR-0003: AdaSuon - 结构-统计互斥性原理的证伪实验"
status: "Accepted"
date: "2025-11-30"
authors: "Ω Researcher"
tags: ["optimizer", "first-principles", "failure-analysis"]
supersedes: "ADR-0002"
---

# ADR-0003: AdaSuon - 结构-统计互斥性原理的证伪实验

## 状态 (Status)

Proposed | **Accepted** | Rejected | Superseded | Deprecated

## 背景 (Context)

在 `ADR-0002` 的探索失败后，我们回归到一个更基本的问题：`RMSuon` 的成功是否源于它巧妙地**避免**了 `Muon` 的结构化更新与 `AdamW` 的逐元素自适应性的直接冲突？我们假设，这两种优化范式在底层是互斥的。为了验证这一核心假设，我们设计了 `AdaSuon` 优化器。

`AdaSuon` 被设计为两种范式的最直接、最鲁莽的结合：它将 `Muon` 正交化后的梯度 `O`，直接用 `AdamW` 的逐元素分母 `√v̂` 进行缩放。

- **`RMSuon`**: `Update ~ (||m̂/√v̂||) * O` (标量能量 * 结构化方向)
- **`AdaSuon`**: `Update ~ O / √v̂` (结构化方向 / 逐元素统计)

## 决策 (Decision)

我们执行了 `AdaSuon` 在 `wikitext-2` 任务上的训练实验，以期证伪或验证我们的**结构-统计互斥性原理**。

## 后果 (Consequences)

### 实验结果

实验结果是灾难性的，但极具启发性。

| Epoch | Train Loss | Eval Perplexity | Grad Norm |
| :--- | :--- | :--- | :--- |
| 1 | 6.5858 | 454.31 | 1.0043 |
| 2 | 5.7144 | 317.71 | 0.8924 |
| 3 | 5.3688 | **296.63** | 0.9497 |
| 4 | 6.3339 | 2513.23 | 2.4280 |
| 5 | 9.1411 | 16376.52 | 5.1071 |

训练在第 3 个 epoch 后完全崩溃，训练损失和验证 PPL 双双爆炸。

### 理论分析：互斥性原理被证实

`AdaSuon` 的失败完美地证实了我们的核心假设。这次失败不是一次简单的调参失误，它揭示了一个关于二阶（及伪二阶）优化器设计的基本原理：

**结构保持 (Structure-Preserving) 与 逐元素自适应 (Element-wise Adaptive) 是两种根本上互斥的优化哲学。任何试图将它们生硬结合的尝试，都将导致优化动力学的崩溃。**

- **几何撕裂 (Geometric Tearing)**: `Muon` 的 `Newton-Schulz` 迭代产生了一个谱范数为 1 的正交矩阵 `O`，它在几何上是等距和结构稳定的。而 `AdamW` 的 `√v̂` 分母是一个逐元素的、高度异质的缩放场。将 `O` 逐元素地除以 `√v̂`，相当于用一个粗糙的地形图去撕扯一张均匀的网格，彻底破坏了 `O` 的正交性和谱范数特性。`√v̂` 中任何接近于零的元素都会在更新中制造出数值尖峰，导致梯度爆炸。

### 结论

1. **`RMSuon` 的成功之谜被揭开**: `RMSuon` 之所以能工作，恰恰是因为它**避免**了这种几何撕裂。它聪明地将 `AdamW` 的逐元素统计信息**降维**成一个**标量 `energy`**，用这个标量去缩放整个正交矩阵 `O`。这保留了 `O` 的几何完整性，虽然引入了“唯一信息再注入”的过拟合问题，但至少在动力学上是稳定的。

2. **划定研究红线**: 这个实验为我们未来的研究划定了一条清晰的红线。我们不能再试图将“结构保持”和“逐元素自适应”这两种范式进行天真的混合。

3. **未来方向**: 既然我们理解了 `RMSuon` 过拟合的根源（标量 `energy` 注入了过多的唯一信息），并且也理解了为什么不能用逐元素的方式去修正它，那么未来的方向应该是：**寻找一种新的、结构化的、非逐元素的方式来调节 `energy` 的注入强度**。这再次将我们引向了对 `weight_decay` 的重新思考，但这一次，我们带着更深刻的理解。

`AdaSuon` 作为一个失败的探针，其价值远超一个成功的优化器。它澄清了我们理论框架中的一个核心矛盾，为后续研究扫清了道路。
